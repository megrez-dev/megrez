{"version":3,"sources":["webpack:///./src/components/image/Image.vue?5377","webpack:///./src/components/image/Image.vue?57de","webpack:///./node_modules/tdesign-icons-vue/esm/components/loading.js","webpack:///src/components/image/Image.vue","webpack:///./src/components/image/Image.vue?ac04","webpack:///./src/components/image/Image.vue","webpack:///./src/components/attachment/AttachSelectDrawer.vue?91e1","webpack:///./src/components/image/constants.js","webpack:///./src/components/attachment/AttachDetailDrawer.vue?f4ff","webpack:///./src/components/attachment/AttachUploadDialog.vue?8840","webpack:///./src/components/attachment/AttachSelectDrawer.vue?d181","webpack:///./src/components/attachment/AttachUploadDialog.vue?900f","webpack:///src/components/attachment/AttachUploadDialog.vue","webpack:///./src/components/attachment/AttachUploadDialog.vue?f138","webpack:///./src/components/attachment/AttachUploadDialog.vue","webpack:///./src/components/attachment/AttachDetailDrawer.vue?aa54","webpack:///src/components/attachment/AttachDetailDrawer.vue","webpack:///./src/components/attachment/AttachDetailDrawer.vue?83be","webpack:///./src/components/attachment/AttachDetailDrawer.vue","webpack:///./node_modules/tdesign-icons-vue/esm/components/info-circle.js","webpack:///src/components/attachment/AttachSelectDrawer.vue","webpack:///./src/components/attachment/AttachSelectDrawer.vue?c249","webpack:///./src/components/attachment/AttachSelectDrawer.vue"],"names":["_vm","this","_h","$createElement","_c","_self","staticClass","style","$attrs","on","$event","maskVisable","_e","attrs","error","fallbackSrc","src","alt","opacity","cursor","$slots","maskInner","handleMaskClick","preview","_v","_s","_t","staticRenderFns","_excluded","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","Loading","extend","name","functional","props","size","type","String","onClick","Function","render","createElement","context","data","otherProps","_useSizeProps","className","fullProps","id","icon","isSupportObjectFit","undefined","document","documentElement","objectFit","ObjectFit","NONE","CONTAIN","COVER","FILL","SCALE_DOWN","components","LoadingIcon","BrowseIcon","fit","fallback","default","viewerOptions","required","maskClass","loading","imageWidth","imageHeight","computed","imageStyle","mounted","methods","loadImage","img","handleLoad","handleError","handlePreview","images","options","getImageStyle","clientWidth","clientHeight","width","height","component","defaultImageUrl","movable","title","navbar","toolbar","zoomIn","zoomOut","oneToOne","reset","prev","play","next","rotateLeft","rotateRight","flipHorizontal","flipVertical","visible","close","scopedSlots","_u","fn","onClickUpload","slot","mode","selectedNum","onClickComplete","maxNum","proxy","model","value","callback","$$v","keywords","expression","_l","attach","index","class","getIndexInSelected","url","staticStyle","stopPropagation","previewImage","previewAttach","pagination","pageNum","total","onPaginationChange","ref","syncData","handleUploadSuccess","handleUploadFail","uploadMethod","files","open","file","post","headers","then","resolve","status","response","catch","deleteAttach","attachment","fileName","attachmentStorageType","uploadTime","copyURL","copyMarkdown","FileCopyIcon","InfoCircle","AttachUploadDialog","AttachDetailDrawer","MImage","UploadIcon","InfoCircleIcon","hasInit","attachments","selectedAttaches","pageSize","watch","current","get","params","finally","indexInSelected","select","unSelect"],"mappings":"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","file":"js/chunk-cfec1636.7111860e.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Image.vue?vue&type=style&index=0&id=031a8c61&prod&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"megrez-image\",style:(_vm.$attrs.style),on:{\"mouseenter\":function($event){_vm.maskVisable = true},\"mouseleave\":function($event){_vm.maskVisable = false}}},[(_vm.loading)?_c('div',{staticClass:\"megrez-image-loading\"},[_c('LoadingIcon')],1):_vm._e(),_c('img',{staticClass:\"megrez-image-img\",style:(_vm.imageStyle),attrs:{\"src\":_vm.error ? _vm.fallbackSrc : _vm.src,\"alt\":_vm.alt}}),_c('div',{staticClass:\"megrez-image-mask\",style:({ opacity: _vm.maskVisable ? 1 : 0, cursor: _vm.$slots.maskInner ? 'default' : 'pointer' }),on:{\"click\":_vm.handleMaskClick}},[(!_vm.$slots.maskInner && _vm.preview)?_c('span',[_c('BrowseIcon'),_vm._v(_vm._s(typeof _vm.preview === 'string' ? _vm.preview : '预览'))],1):_vm._t(\"maskInner\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { _ as _defineProperty } from '../_chunks/dep-869d1f34.js';\nimport { _ as _objectWithoutProperties } from '../_chunks/dep-e6b778f4.js';\nimport Vue from 'vue';\nimport IconBase from '../icon.js';\nimport useSizeProps from '../utils/use-size-props.js';\nimport 'classnames';\nimport '../style/css.js';\nimport '../utils/use-common-classname.js';\nimport '../utils/config-context.js';\n\nvar _excluded = [\"size\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nvar element = {\n  \"tag\": \"svg\",\n  \"attrs\": {\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"1em\",\n    \"height\": \"1em\"\n  },\n  \"children\": [{\n    \"tag\": \"path\",\n    \"attrs\": {\n      \"fill\": \"currentColor\",\n      \"d\": \"M8 1.5a6.5 6.5 0 000 13v-1.63A4.87 4.87 0 1112.88 8h1.62A6.5 6.5 0 008 1.5z\",\n      \"fillOpacity\": 0.9\n    }\n  }]\n};\nvar Loading = Vue.extend({\n  name: \"LoadingIcon\",\n  functional: true,\n  props: {\n    size: {\n      type: String\n    },\n    onClick: {\n      type: Function\n    }\n  },\n  render: function render(createElement, context) {\n    var props = context.props,\n        data = context.data;\n\n    var size = props.size,\n        otherProps = _objectWithoutProperties(props, _excluded);\n\n    var _useSizeProps = useSizeProps(size),\n        className = _useSizeProps.className,\n        style = _useSizeProps.style;\n\n    var fullProps = _objectSpread(_objectSpread({}, otherProps || {}), {}, {\n      id: \"loading\",\n      icon: element,\n      staticClass: className,\n      style: style\n    });\n\n    data.props = fullProps;\n    return createElement(IconBase, data);\n  }\n});\n\nexport { Loading as default };\n//# sourceMappingURL=loading.js.map\n","<template>\r\n  <div\r\n    class=\"megrez-image\"\r\n    :style=\"$attrs.style\"\r\n    @mouseenter=\"maskVisable = true\"\r\n    @mouseleave=\"maskVisable = false\"\r\n  >\r\n    <div class=\"megrez-image-loading\" v-if=\"loading\"><LoadingIcon /></div>\r\n    <img\r\n      class=\"megrez-image-img\"\r\n      :src=\"error ? fallbackSrc : src\"\r\n      :alt=\"alt\"\r\n      :style=\"imageStyle\"\r\n    />\r\n    <div\r\n      :style=\"{ opacity: maskVisable ? 1 : 0, cursor: $slots.maskInner ? 'default' : 'pointer' }\"\r\n      class=\"megrez-image-mask\"\r\n      @click=\"handleMaskClick\"\r\n    >\r\n      <!-- 父组件可以通过slot定义mask内展示内容 -->\r\n      <span v-if=\"!$slots.maskInner && preview\" ><BrowseIcon />{{ typeof preview === 'string' ?  preview : '预览' }}</span>\r\n      <slot v-else name=\"maskInner\"></slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { BrowseIcon, LoadingIcon } from 'tdesign-icons-vue';\r\nimport { viewerOptions, defaultImageUrl } from '@/components/image/constants';\r\n\r\nconst isSupportObjectFit = () => document.documentElement.style.objectFit !== undefined;\r\nconst ObjectFit = {\r\n  NONE: 'none',\r\n  CONTAIN: 'contain',\r\n  COVER: 'cover',\r\n  FILL: 'fill',\r\n  SCALE_DOWN: 'scale-down',\r\n};\r\nexport default {\r\n  name: 'MegrezImage',\r\n  components: {\r\n    LoadingIcon,\r\n    BrowseIcon,\r\n  },\r\n  props: {\r\n    src: String,\r\n    alt: String,\r\n    fit: String,\r\n    fallback: String,\r\n    preview: {\r\n      type: [ Boolean, String ],\r\n      default: true,\r\n    },\r\n    // 用于配置v-viewer\r\n    viewerOptions: {\r\n      type: Object,\r\n      required: false,\r\n      default: () => {\r\n        return {};\r\n      },\r\n    },\r\n    maskClass: {\r\n      type: String || Array,\r\n      required: false,\r\n      default: '',\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      error: false,\r\n      loading: true,\r\n      imageWidth: 0,\r\n      imageHeight: 0,\r\n      maskVisable: false,\r\n    };\r\n  },\r\n  computed: {\r\n    imageStyle() {\r\n      const { fit } = this;\r\n      if (fit) {\r\n        return isSupportObjectFit() ? { 'object-fit': fit } : this.getImageStyle(fit);\r\n      }\r\n      return {};\r\n    },\r\n    fallbackSrc() {\r\n      return this.fallback || defaultImageUrl;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.loadImage();\r\n  },\r\n  methods: {\r\n    loadImage() {\r\n      this.loading = true;\r\n      this.error = false;\r\n      const img = new Image();\r\n      img.onload = (e) => this.handleLoad(e, img);\r\n      img.onerror = this.handleError.bind(this);\r\n      img.src = this.src;\r\n    },\r\n    handleLoad(e, img) {\r\n      this.imageWidth = img.width;\r\n      this.imageHeight = img.height;\r\n      this.loading = false;\r\n      this.error = false;\r\n      this.$emit('load', e);\r\n    },\r\n    handleError(e) {\r\n      this.loading = false;\r\n      this.error = true;\r\n      this.$emit('error', e);\r\n    },\r\n    handleMaskClick(e) {\r\n      this.$emit('maskClick', e);\r\n      if (!this.$slots.maskInner && this.preview) this.handlePreview();\r\n    },\r\n    handlePreview() {\r\n      this.$viewerApi({\r\n        images: [this.src],\r\n        options: { ...viewerOptions, ...this.viewerOptions },\r\n      });\r\n    },\r\n    // 参考element-ui，低版本浏览器没有object-fit方法，需要用此兼容\r\n    getImageStyle(fit) {\r\n      const { imageWidth, imageHeight } = this;\r\n      const { clientWidth: containerWidth, clientHeight: containerHeight } = this.$el;\r\n\r\n      if (!imageWidth || !imageHeight || !containerWidth || !containerHeight) return {};\r\n\r\n      const imageAspectRatio = imageWidth / imageHeight;\r\n      const containerAspectRatio = containerWidth / containerHeight;\r\n\r\n      if (fit === ObjectFit.SCALE_DOWN) {\r\n        const isSmaller = imageWidth < containerWidth && imageHeight < containerHeight;\r\n        fit = isSmaller ? ObjectFit.NONE : ObjectFit.CONTAIN;\r\n      }\r\n\r\n      switch (fit) {\r\n        case ObjectFit.NONE:\r\n          return { width: 'auto', height: 'auto' };\r\n        case ObjectFit.CONTAIN:\r\n          return imageAspectRatio < containerAspectRatio ? { width: 'auto' } : { height: 'auto' };\r\n        case ObjectFit.COVER:\r\n          return imageAspectRatio < containerAspectRatio ? { height: 'auto' } : { width: 'auto' };\r\n        default:\r\n          return {};\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.megrez-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: inline-block;\r\n  position: relative;\r\n  .megrez-image-loading {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n  .megrez-image-img {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    vertical-align: middle;\r\n    z-index: 100;\r\n  }\r\n  .megrez-image-mask {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    color: @text-color-anti;\r\n    background-color: @mask-active;\r\n    opacity: 0;\r\n    z-index: 200;\r\n    transition: all 0.2s;\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Image.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Image.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Image.vue?vue&type=template&id=031a8c61&scoped=true&\"\nimport script from \"./Image.vue?vue&type=script&lang=js&\"\nexport * from \"./Image.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Image.vue?vue&type=style&index=0&id=031a8c61&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"031a8c61\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachSelectDrawer.vue?vue&type=style&index=0&id=15c73856&prod&lang=less&scoped=true&\"","export const defaultImageUrl = 'http://119.91.26.252:8090/images/placeholder.jpg';\r\nexport const viewerOptions = {\r\n  movable: false,\r\n  title: false,\r\n  navbar: false,\r\n  toolbar: {\r\n    zoomIn: 4,\r\n    zoomOut: 4,\r\n    oneToOne: 4,\r\n    reset: 4,\r\n    prev: 0,\r\n    play: 0,\r\n    next: 0,\r\n    rotateLeft: 4,\r\n    rotateRight: 4,\r\n    flipHorizontal: 0,\r\n    flipVertical: 0,\r\n  },\r\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachDetailDrawer.vue?vue&type=style&index=0&id=25d0abba&prod&lang=less&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachUploadDialog.vue?vue&type=style&index=0&id=30538db6&prod&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('t-drawer',{attrs:{\"header\":\"附件列表\",\"visible\":_vm.visible,\"onClose\":_vm.close,\"closeBtn\":true,\"size\":\"400px\",\"zIndex\":2600,\"onOverlayClick\":_vm.close,\"placement\":\"right\"},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('t-button',{on:{\"click\":_vm.onClickUpload}},[_c('UploadIcon',{attrs:{\"slot\":\"icon\"},slot:\"icon\"}),_vm._v(\" 上传附件 \")],1),(_vm.mode === 'multiple')?_c('span',{staticClass:\"complete-button\"},[_c('t-button',{attrs:{\"theme\":\"danger\",\"disabled\":_vm.selectedNum <= 0},on:{\"click\":_vm.onClickComplete}},[_vm._v(\" 完成\"+_vm._s(_vm.maxNum > 0 ? (\"(\" + _vm.selectedNum + \"/\" + _vm.maxNum + \")\") : '')+\" \")])],1):_vm._e()]},proxy:true}])},[_c('t-row',{attrs:{\"gutter\":[16, 16]}},[_c('t-col',[_c('t-input',{attrs:{\"placeholder\":\"通过关键词搜索\"},model:{value:(_vm.keywords),callback:function ($$v) {_vm.keywords=$$v},expression:\"keywords\"}})],1)],1),_c('t-skeleton',{staticClass:\"images-skeleton\",attrs:{\"animation\":\"gradient\",\"loading\":_vm.loading,\"delay\":300}},[_c('div',{staticClass:\"images-wrapper\"},_vm._l((_vm.attachments),function(attach,index){return _c('m-image',{key:attach.id,staticClass:\"image-item\",class:_vm.getIndexInSelected(attach) >= 0 ? 'image-selected' : '',attrs:{\"fit\":\"cover\",\"src\":attach.url},on:{\"maskClick\":function($event){return _vm.handleMaskClick(attach, index)}}},[_c('template',{slot:\"maskInner\"},[_c('span',{staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.previewImage(attach.url)}}},[_c('BrowseIcon',{attrs:{\"size\":\"1.1em\"}}),_vm._v(\" 预览 \")],1),_c('t-divider',{attrs:{\"layout\":\"vertical\"}}),_c('span',{staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.previewAttach(attach)}}},[_c('InfoCircleIcon',{attrs:{\"size\":\"1.1em\"}}),_vm._v(\" 详情 \")],1)],1)],2)}),1)]),_c('t-pagination',{attrs:{\"current\":_vm.pagination.pageNum,\"total\":_vm.pagination.total,\"pageSizeOptions\":[]},on:{\"change\":_vm.onPaginationChange}})],1),_c('AttachDetailDrawer',{ref:\"attachDetailDrawer\"}),_c('AttachUploadDialog',{ref:\"attachUploadDialog\",on:{\"uploadSuccess\":_vm.syncData}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('t-dialog',{attrs:{\"visible\":_vm.visible,\"header\":null,\"confirmBtn\":null,\"cancelBtn\":null,\"onClose\":_vm.close,\"zIndex\":2601}},[_c('div',{staticClass:\"upload-container\"},[_c('t-upload',{attrs:{\"theme\":\"image\",\"onSuccess\":_vm.handleUploadSuccess,\"onFail\":_vm.handleUploadFail,\"requestMethod\":_vm.uploadMethod,\"draggable\":\"\",\"accept\":\"image/*\"},model:{value:(_vm.files),callback:function ($$v) {_vm.files=$$v},expression:\"files\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <t-dialog\n    :visible=\"visible\"\n    :header=\"null\"\n    :confirmBtn=\"null\"\n    :cancelBtn=\"null\"\n    :onClose=\"close\"\n    :zIndex=\"2601\"\n  >\n    <div class=\"upload-container\">\n      <t-upload\n        v-model=\"files\"\n        theme=\"image\"\n        :onSuccess=\"handleUploadSuccess\"\n        :onFail=\"handleUploadFail\"\n        :requestMethod=\"uploadMethod\"\n        draggable\n        accept=\"image/*\"\n      ></t-upload>\n    </div>\n  </t-dialog>\n</template>\n<script>\nexport default {\n  name: \"AttachUploadDialog\",\n  data() {\n    return {\n      visible: false,\n      files: [],\n    };\n  },\n  computed: {},\n  methods: {\n    open() {\n      this.visible = true;\n    },\n    close() {\n      this.visible = false;\n    },\n    handleUploadFail() {},\n    handleUploadSuccess() {\n      this.$message.success(\"上传成功\");\n      this.$emit(\"uploadSuccess\");\n      this.files = [];\n      this.close();\n    },\n    uploadMethod(file) {\n      return new Promise((resolve) => {\n        // file.percent 用于控制上传进度，如果不希望显示上传进度，则不对 file.percent 设置值即可。\n        // 如果代码规范不能设置 file.percent，也可以设置 this.files\n        file.percent = 0;\n        let data = new FormData();\n        data.append(\"file\", file.raw);\n        this.$request\n          .post(\"upload\", data, {\n            headers: { \"Content-Type\": \"multipart/form-data\" },\n          })\n          .then((res) => {\n            if (res.status === 0) {\n              resolve({\n                status: \"success\",\n                response: {\n                  url: res.data.url,\n                },\n              });\n            }\n          })\n          .catch(() => {\n            resolve({\n              status: \"fail\",\n              error: \"上传失败，请检查文件是否符合规范\",\n            });\n          });\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.upload-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachUploadDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachUploadDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AttachUploadDialog.vue?vue&type=template&id=30538db6&scoped=true&\"\nimport script from \"./AttachUploadDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./AttachUploadDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AttachUploadDialog.vue?vue&type=style&index=0&id=30538db6&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"30538db6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('t-drawer',{attrs:{\"header\":\"附件详情\",\"visible\":_vm.visible,\"onClose\":_vm.close,\"closeBtn\":true,\"size\":\"480px\",\"zIndex\":2600,\"onOverlayClick\":_vm.close,\"placement\":\"right\"},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('t-button',{on:{\"click\":_vm.deleteAttach}},[_vm._v(\"删除\")])]},proxy:true}])},[(_vm.attachment)?_c('t-list',{attrs:{\"split\":true}},[_c('t-list-item',[_c('t-list-item-meta',{attrs:{\"title\":\"附件名\"}}),_vm._v(\" \"+_vm._s(_vm.attachment.fileName)+\" \")],1),_c('t-list-item',[_c('t-list-item-meta',{attrs:{\"title\":\"存储位置\"}}),_vm._v(\" \"+_vm._s(_vm.attachmentStorageType)+\" \")],1),_c('t-list-item',[_c('t-list-item-meta',{attrs:{\"title\":\"图片大小\"}}),_vm._v(\" \"+_vm._s(_vm.attachment.size)+\" \")],1),_c('t-list-item',[_c('t-list-item-meta',{attrs:{\"title\":\"图片尺寸\"}}),_vm._v(\" \"+_vm._s(_vm.attachment.height)+\" x \"+_vm._s(_vm.attachment.width)+\" \")],1),_c('t-list-item',[_c('t-list-item-meta',{attrs:{\"title\":\"上传日期\"}}),_vm._v(\" \"+_vm._s(_vm.attachment.uploadTime)+\" \")],1),_c('t-list-item',{scopedSlots:_vm._u([{key:\"action\",fn:function(){return [_c('t-button',{attrs:{\"variant\":\"text\",\"shape\":\"square\"},on:{\"click\":_vm.copyURL}},[_c('file-copy-icon')],1)]},proxy:true}],null,false,320530126)},[_c('t-list-item-meta',{attrs:{\"title\":\"图片链接\"}}),_vm._v(\" \"+_vm._s(_vm.attachment.url)+\" \")],1),_c('t-list-item',{scopedSlots:_vm._u([{key:\"action\",fn:function(){return [_c('t-button',{attrs:{\"variant\":\"text\",\"shape\":\"square\"},on:{\"click\":_vm.copyMarkdown}},[_c('file-copy-icon')],1)]},proxy:true}],null,false,765174242)},[_c('t-list-item-meta',{attrs:{\"title\":\"Markdown 链接\"}}),_vm._v(\" ![\"+_vm._s(_vm.attachment.fileName)+\"](\"+_vm._s(_vm.attachment.url)+\") \")],1)],1):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <t-drawer\n      header=\"附件详情\"\n      :visible=\"visible\"\n      :onClose=\"close\"\n      :closeBtn=\"true\"\n      size=\"480px\"\n      :zIndex=\"2600\"\n      :onOverlayClick=\"close\"\n      placement=\"right\"\n    >\n      <t-list :split=\"true\" v-if=\"attachment\">\n        <t-list-item>\n          <t-list-item-meta title=\"附件名\"></t-list-item-meta>\n          {{ attachment.fileName }}\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"存储位置\"></t-list-item-meta>\n          {{ attachmentStorageType }}\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"图片大小\"></t-list-item-meta>\n          {{ attachment.size }}\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"图片尺寸\"></t-list-item-meta>\n          {{ attachment.height }} x {{ attachment.width }}\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"上传日期\"></t-list-item-meta>\n          {{ attachment.uploadTime }}\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"图片链接\"></t-list-item-meta>\n          {{ attachment.url }}\n          <template #action>\n            <t-button variant=\"text\" shape=\"square\" @click=\"copyURL\"\n              ><file-copy-icon\n            /></t-button>\n          </template>\n        </t-list-item>\n        <t-list-item>\n          <t-list-item-meta title=\"Markdown 链接\"></t-list-item-meta>\n          ![{{ attachment.fileName }}]({{ attachment.url }})\n          <template #action>\n            <t-button variant=\"text\" shape=\"square\" @click=\"copyMarkdown\"\n              ><file-copy-icon\n            /></t-button>\n          </template>\n        </t-list-item>\n      </t-list>\n      <template #footer>\n        <t-button @click=\"deleteAttach\">删除</t-button>\n      </template>\n    </t-drawer>\n  </div>\n</template>\n\n<script>\nimport { FileCopyIcon } from \"tdesign-icons-vue\";\nexport default {\n  name: \"AttachDetailDrawer\",\n  data() {\n    return {\n      attachment: {},\n      visible: false,\n    };\n  },\n  computed: {\n    attachmentStorageType() {\n      switch (this.attachment.type) {\n        case \"local\":\n          return \"本地\";\n        case \"qcloud_cos\":\n          return \"腾讯云 COS\";\n        case \"aliyun_oss\":\n          return \"阿里云 OSS\";\n        case \"huawei_obs\":\n          return \"华为 OBS\";\n        case \"qiniuyun\":\n          return \"七牛云\";\n        case \"youpaiyun\":\n          return \"又拍云\";\n        default:\n          return \"未知\";\n      }\n    },\n  },\n  methods: {\n    open(attachment) {\n      this.visible = true;\n      this.attachment = attachment;\n    },\n    close() {\n      this.visible = false;\n    },\n    deleteAttach() {\n      this.$message.info(\"未实现\");\n    },\n    copyURL() {\n      this.$copyText(this.attachment.url);\n      this.$message.success(\"已复制\");\n    },\n    copyMarkdown() {\n      this.$copyText(`![${this.attachment.fileName}](${this.attachment.url})`);\n      this.$message.success(\"已复制\");\n    },\n  },\n  components: { FileCopyIcon },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.image-wrapper {\n  margin: 0 auto;\n  justify-content: center;\n  img {\n    height: 175px;\n    align-items: center;\n    margin: 0 auto;\n    border-radius: 2px;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachDetailDrawer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachDetailDrawer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AttachDetailDrawer.vue?vue&type=template&id=25d0abba&scoped=true&\"\nimport script from \"./AttachDetailDrawer.vue?vue&type=script&lang=js&\"\nexport * from \"./AttachDetailDrawer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AttachDetailDrawer.vue?vue&type=style&index=0&id=25d0abba&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25d0abba\",\n  null\n  \n)\n\nexport default component.exports","import { _ as _defineProperty } from '../_chunks/dep-869d1f34.js';\nimport { _ as _objectWithoutProperties } from '../_chunks/dep-e6b778f4.js';\nimport Vue from 'vue';\nimport IconBase from '../icon.js';\nimport useSizeProps from '../utils/use-size-props.js';\nimport 'classnames';\nimport '../style/css.js';\nimport '../utils/use-common-classname.js';\nimport '../utils/config-context.js';\n\nvar _excluded = [\"size\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nvar element = {\n  \"tag\": \"svg\",\n  \"attrs\": {\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"1em\",\n    \"height\": \"1em\"\n  },\n  \"children\": [{\n    \"tag\": \"path\",\n    \"attrs\": {\n      \"fill\": \"currentColor\",\n      \"d\": \"M7.5 12V6.5h1V12h-1zM8.6 4H7.4v1.2h1.2V4z\",\n      \"fillOpacity\": 0.9\n    }\n  }, {\n    \"tag\": \"path\",\n    \"attrs\": {\n      \"fill\": \"currentColor\",\n      \"d\": \"M1 8a7 7 0 1014 0A7 7 0 001 8zm1 0a6 6 0 1112 0A6 6 0 012 8z\",\n      \"fillOpacity\": 0.9\n    }\n  }]\n};\nvar InfoCircle = Vue.extend({\n  name: \"InfoCircleIcon\",\n  functional: true,\n  props: {\n    size: {\n      type: String\n    },\n    onClick: {\n      type: Function\n    }\n  },\n  render: function render(createElement, context) {\n    var props = context.props,\n        data = context.data;\n\n    var size = props.size,\n        otherProps = _objectWithoutProperties(props, _excluded);\n\n    var _useSizeProps = useSizeProps(size),\n        className = _useSizeProps.className,\n        style = _useSizeProps.style;\n\n    var fullProps = _objectSpread(_objectSpread({}, otherProps || {}), {}, {\n      id: \"info-circle\",\n      icon: element,\n      staticClass: className,\n      style: style\n    });\n\n    data.props = fullProps;\n    return createElement(IconBase, data);\n  }\n});\n\nexport { InfoCircle as default };\n//# sourceMappingURL=info-circle.js.map\n","<template>\n  <div>\n    <t-drawer header=\"附件列表\" :visible=\"visible\" :onClose=\"close\" :closeBtn=\"true\" size=\"400px\" :zIndex=\"2600\"\n      :onOverlayClick=\"close\" placement=\"right\">\n      <t-row :gutter=\"[16, 16]\">\n        <t-col>\n          <t-input v-model=\"keywords\" placeholder=\"通过关键词搜索\"></t-input>\n        </t-col>\n      </t-row>\n      <t-skeleton class=\"images-skeleton\" animation=\"gradient\" :loading=\"loading\" :delay=\"300\">\n        <div class=\"images-wrapper\">\n          <m-image fit=\"cover\" v-for=\"(attach, index) in attachments\" class=\"image-item\"\n          :class=\"getIndexInSelected(attach) >= 0 ? 'image-selected' : ''\" :src=\"attach.url\" :key=\"attach.id\"\n          @maskClick=\"handleMaskClick(attach, index)\">\n          <template slot=\"maskInner\">\n            <span style=\"cursor: pointer\" @click.stop=\"previewImage(attach.url)\">\n              <BrowseIcon size=\"1.1em\" /> 预览\n            </span>\n            <t-divider layout=\"vertical\"></t-divider>\n            <span style=\"cursor: pointer\" @click.stop=\"previewAttach(attach)\">\n              <InfoCircleIcon size=\"1.1em\" /> 详情\n            </span>\n          </template>\n        </m-image>\n      </div>\n      </t-skeleton>\n      <t-pagination :current=\"pagination.pageNum\" :total=\"pagination.total\" :pageSizeOptions=\"[]\"\n        @change=\"onPaginationChange\"></t-pagination>\n      <template #footer>\n        <t-button @click=\"onClickUpload\">\n          <UploadIcon slot=\"icon\" />\n          上传附件\n        </t-button>\n        <span class=\"complete-button\" v-if=\"mode === 'multiple'\">\n          <t-button theme=\"danger\" :disabled=\"selectedNum <= 0\" @click=\"onClickComplete\">\n            完成{{ maxNum > 0 ? `(${selectedNum}/${maxNum})` : '' }}\n          </t-button>\n        </span>\n      </template>\n    </t-drawer>\n    <AttachDetailDrawer ref=\"attachDetailDrawer\"></AttachDetailDrawer>\n    <AttachUploadDialog ref=\"attachUploadDialog\" @uploadSuccess=\"syncData\"></AttachUploadDialog>\n  </div>\n</template>\n\n<script>\nimport AttachUploadDialog from '@/components/attachment/AttachUploadDialog.vue';\nimport AttachDetailDrawer from '@/components/attachment/AttachDetailDrawer.vue';\nimport MImage from '@/components/image/Image.vue';\nimport { viewerOptions } from '@/components/image/constants';\nimport { UploadIcon, BrowseIcon, InfoCircleIcon } from 'tdesign-icons-vue';\n\nexport default {\n  name: 'AttachSelectDrawer',\n  components: {\n    AttachUploadDialog,\n    AttachDetailDrawer,\n    MImage,\n    UploadIcon,\n    BrowseIcon,\n    InfoCircleIcon,\n  },\n  data() {\n    return {\n      hasInit: false,\n      keywords: '',\n      attachments: [],\n      loading: false,\n      selectedAttaches: [],\n      pagination: {\n        pageSize: 10,\n        pageNum: 1,\n        total: 0,\n      },\n    };\n  },\n  props: {\n    mode: {\n      type: String,\n      required: false,\n      default: 'single',\n    },\n    // AttachSelectDrawer现在为受控组件，是否展示受控于父组件传递的visible属性\n    visible: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n    maxNum: {\n      type: [Number, String],\n      default: 0,\n    },\n  },\n  computed: {\n    selectedNum() {\n      return this.selectedAttaches.length;\n    },\n  },\n  watch: {\n    visible(newVal) {\n      if (newVal) {\n        this.$emit('open');\n        // 若未初始化，则请求数据，进行数据的初始化\n        if (this.hasInit) return;\n        this.hasInit = true;\n        this.syncData();\n      } else {\n        this.$emit('close');\n      }\n    },\n  },\n  methods: {\n    close() {\n      // 同步更新visible值，需要父组件传参时添加.sync修饰符\n      this.$emit('update:visible', false);\n      this.$emit('close');\n      this.selectedAttaches = [];\n    },\n    onClickUpload() {\n      this.$refs.attachUploadDialog.open();\n    },\n    onPaginationChange(pagination) {\n      if (pagination) {\n        const { current: pageNum, pageSize } = pagination;\n        this.pagination = { ...this.pagination, pageNum, pageSize };\n      }\n      this.syncData();\n    },\n    syncData() {\n      this.loading = true;\n      const { pageNum, pageSize } = this.pagination;\n      this.$request\n        .get('attachments', { params: { pageNum, pageSize } })\n        .then((res) => {\n          if (res.status === 0) {\n            this.pagination.total = res.data.total;\n            this.attachments = res.data.list || [];\n          } else {\n            this.$message.error('获取附件列表失败');\n          }\n        })\n        .catch(() => {\n          this.$message.error('获取附件列表失败');\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n    previewAttach(attach) {\n      this.$refs.attachDetailDrawer.open(attach);\n    },\n    previewImage(url) {\n      this.$viewerApi({\n        images: [url],\n        options: viewerOptions,\n      });\n    },\n    handleMaskClick(attach) {\n      const indexInSelected = this.getIndexInSelected(attach);\n      // 如果attach在selectedAttaches中，说明已经被选中，则执行取消选择操作\n      indexInSelected >= 0 ? this.unSelect(indexInSelected) : this.select(attach);\n    },\n    getIndexInSelected(attach) {\n      return this.selectedAttaches.findIndex((selectedAttach) => selectedAttach.id === attach.id);\n    },\n    select(attach) {\n      const maxNum = Number(this.maxNum);\n      if (maxNum > 0 && maxNum <= this.selectedNum) {\n        this.$message.warning('最多只能选择' + maxNum + '个附件');\n        return;\n      }\n      this.selectedAttaches.push(attach);\n      if (this.mode === 'single') {\n        this.$emit('select', attach);\n        this.close();\n        return;\n      }\n    },\n    unSelect(deleteIndex) {\n      this.selectedAttaches.splice(deleteIndex, 1);\n    },\n    onClickComplete() {\n      this.$emit(\n        'select',\n        this.selectedAttaches,\n      );\n      this.close();\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n@image-wrapper-height: calc(100% - 84px);\n.images-skeleton {\n  width: 100%;\n  margin: 10px 0px;\n  height: @image-wrapper-height;\n}\n.images-wrapper {\n  position: relative;\n  display: flex;\n  align-content: flex-start;\n  flex-wrap: wrap;\n  height: 100%;\n  width: 100%;\n  margin: 10px 0px;\n  overflow: auto;\n  .image-item {\n    position: relative;\n    flex: 1 1 160px;\n    height: 170px;\n    margin: 2px;\n    overflow: hidden;\n    background-color: @bg-color-secondarycontainer;\n    border: 5px solid var(--td-bg-color-container);\n    &.image-selected {\n      border: 5px solid @brand-color-6;\n    }\n  }\n}\n\n.complete-button {\n  float: right;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachSelectDrawer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AttachSelectDrawer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AttachSelectDrawer.vue?vue&type=template&id=15c73856&scoped=true&\"\nimport script from \"./AttachSelectDrawer.vue?vue&type=script&lang=js&\"\nexport * from \"./AttachSelectDrawer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AttachSelectDrawer.vue?vue&type=style&index=0&id=15c73856&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"15c73856\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}